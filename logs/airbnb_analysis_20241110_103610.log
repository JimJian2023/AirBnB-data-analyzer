2024-11-10 10:36:10,416 [INFO] advanced_analyzer.py:192 - === 开始Airbnb数据收集程序 ===
2024-11-10 10:36:10,587 [INFO] advanced_analyzer.py:33 - 成功读取 3 个房间信息
2024-11-10 10:36:10,587 [INFO] advanced_analyzer.py:203 - 生成 3 个URL
2024-11-10 10:36:10,587 [INFO] advanced_analyzer.py:207 - 创建数据目录: data/airbnb_data_20241110_103610
2024-11-10 10:36:10,587 [INFO] advanced_analyzer.py:121 - === 开始批量分析房源 ===
2024-11-10 10:36:12,364 [INFO] advanced_analyzer.py:67 - Chrome WebDriver 初始化成功
2024-11-10 10:36:12,365 [INFO] advanced_analyzer.py:129 - 
处理第 1/3 个房源
2024-11-10 10:36:12,365 [INFO] advanced_analyzer.py:75 - 
开始分析房源: https://www.airbnb.co.nz/rooms/1125096139567330802 (最小入住: 1晚)
2024-11-10 10:36:12,365 [INFO] airbnb_calendar_checker.py:70 - 开始检查房源日历: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 10:36:13,188 [INFO] airbnb_calendar_checker.py:75 - 页面加载中...
2024-11-10 10:36:13,191 [INFO] airbnb_calendar_checker.py:82 - 页面基本加载完成
2024-11-10 10:36:28,416 [INFO] airbnb_calendar_checker.py:120 - 找到日历按钮: //button[contains(@aria-label, 'Choose')]
2024-11-10 10:36:28,419 [INFO] airbnb_calendar_checker.py:134 - 已滚动到日历按钮位置
2024-11-10 10:36:29,420 [INFO] airbnb_calendar_checker.py:139 - 日历按钮已准备就绪
2024-11-10 10:36:30,530 [INFO] airbnb_calendar_checker.py:153 - JavaScript点击日历按钮成功
2024-11-10 10:36:40,739 [INFO] airbnb_calendar_checker.py:184 - 日历内容已加载: //div[contains(@data-testid, 'calendar')]
2024-11-10 10:36:40,751 [INFO] airbnb_calendar_checker.py:199 - 找到 123 个日期单元格
2024-11-10 10:36:40,869 [INFO] airbnb_calendar_checker.py:211 - 找到 123 个日期单元格
2024-11-10 10:36:40,870 [INFO] airbnb_calendar_checker.py:256 - 原始单元格数量: 123
2024-11-10 10:36:40,871 [INFO] airbnb_calendar_checker.py:257 - 去重后数据条数: 123
2024-11-10 10:36:40,871 [INFO] airbnb_calendar_checker.py:258 - 处理的唯一日期数: 123
2024-11-10 10:36:40,871 [INFO] airbnb_calendar_checker.py:262 - 收集到 123 条有效日历数据
2024-11-10 10:36:40,871 [INFO] airbnb_calendar_checker.py:22 - 开始导出数据到Excel...
2024-11-10 10:36:40,871 [INFO] airbnb_calendar_checker.py:32 - 处理房源ID: 1125096139567330802
2024-11-10 10:36:40,871 [INFO] airbnb_calendar_checker.py:37 - 将创建文件: data/airbnb_calendar_1125096139567330802_20241110_103640.xlsx
2024-11-10 10:36:40,872 [INFO] airbnb_calendar_checker.py:41 - 创建DataFrame，共 123 行数据
2024-11-10 10:36:40,898 [INFO] airbnb_calendar_checker.py:52 - 数据已成功导出到Excel文件: data/airbnb_calendar_1125096139567330802_20241110_103640.xlsx
2024-11-10 10:36:40,898 [INFO] airbnb_calendar_checker.py:57 - 文件创建成功，大小: 8.94 KB
2024-11-10 10:36:40,898 [INFO] airbnb_calendar_checker.py:265 - 日历数据已成功导出到: data/airbnb_calendar_1125096139567330802_20241110_103640.xlsx
2024-11-10 10:36:40,898 [INFO] advanced_analyzer.py:84 - 成功获取日历数据: 123 条记录
2024-11-10 10:36:40,898 [INFO] price_checker.py:398 - 开始检查房源价格: https://www.airbnb.co.nz/rooms/1125096139567330802 (最小入住: 1晚)
2024-11-10 10:36:40,898 [INFO] price_checker.py:390 - 找到 20 个可预订日期
2024-11-10 10:36:40,899 [INFO] price_checker.py:414 - [1/20] 处理日期: 18/11/2024
2024-11-10 10:36:40,899 [INFO] price_checker.py:146 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 10:36:40,899 [INFO] price_checker.py:147 - 入住日期: 18/11/2024, 最小入住晚数: 1
2024-11-10 10:36:40,899 [INFO] price_checker.py:169 - 访问URL: https://www.airbnb.co.nz/rooms/1125096139567330802?check_in=2024-11-18&check_out=2024-11-19&adults=3&children=0&infants=0
2024-11-10 10:36:46,054 [INFO] price_checker.py:176 - 检查页面状态...
2024-11-10 10:36:46,056 [INFO] price_checker.py:178 - 页面状态: complete
2024-11-10 10:36:48,067 [INFO] price_checker.py:191 - 价格容器已加载并可见
2024-11-10 10:36:48,067 [INFO] price_checker.py:200 - 尝试价格选择器: xpath - //div[@data-testid='book-it-default']//span[contains(@class, '_1y74zjx')]
2024-11-10 10:36:48,074 [INFO] price_checker.py:205 - 找到 0 个价格元素
2024-11-10 10:36:48,074 [INFO] price_checker.py:200 - 尝试价格选择器: xpath - //div[@data-testid='book-it-default']//span[contains(@class, '_tyxjp1')]
2024-11-10 10:36:48,081 [INFO] price_checker.py:205 - 找到 0 个价格元素
2024-11-10 10:36:48,081 [INFO] price_checker.py:200 - 尝试价格选择器: css - div._wgmchy div._1k1ce2w span._1qgfaxb1
2024-11-10 10:36:48,087 [INFO] price_checker.py:205 - 找到 1 个价格元素
2024-11-10 10:36:48,102 [INFO] price_checker.py:210 - 找到可见价格元素: $259 NZD 
$216 NZD 
night
$216 NZD per night, originally $259 NZD
2024-11-10 10:36:48,109 [INFO] price_checker.py:223 - 找到每晚价格元素: $259 NZD 
$216 NZD 
night
$216 NZD per night, originally $259 NZD
2024-11-10 10:36:48,109 [INFO] price_checker.py:229 - 成功解析折扣价格: $216 NZD
2024-11-10 10:36:48,109 [INFO] price_checker.py:242 - 开始获取价格详情...
2024-11-10 10:36:48,115 [INFO] price_checker.py:249 - 价格详情容器已加载
2024-11-10 10:36:48,119 [INFO] price_checker.py:261 - 尝试使用选择器获取价格详情: //div[contains(@class, '_14omvfj')][.//div[text()='Cleaning fee']]//span[contains(@class, '_1k4xcdh')]
2024-11-10 10:36:48,125 [INFO] price_checker.py:270 - 找到 1 个匹配元素
2024-11-10 10:36:48,132 [INFO] price_checker.py:275 - 找到价格元素: $90 NZD (HTML: <span class="_1k4xcdh">$90&nbsp;NZD</span>)
2024-11-10 10:36:48,141 [INFO] price_checker.py:281 - 父元素文本: cleaning feeshow price breakdown$90 nzd
2024-11-10 10:36:48,141 [INFO] price_checker.py:261 - 尝试使用选择器获取价格详情: //div[contains(@class, '_14omvfj')][.//div[text()='Airbnb service fee']]//span[contains(@class, '_1k4xcdh')]
2024-11-10 10:36:48,148 [INFO] price_checker.py:270 - 找到 1 个匹配元素
2024-11-10 10:36:48,153 [INFO] price_checker.py:275 - 找到价格元素: $43 NZD (HTML: <span class="_1k4xcdh">$43&nbsp;NZD</span>)
2024-11-10 10:36:48,164 [INFO] price_checker.py:281 - 父元素文本: airbnb service feeshow price breakdown$43 nzd
2024-11-10 10:36:48,165 [INFO] price_checker.py:289 - ✓ 成功设置服务费: $43 NZD
2024-11-10 10:36:48,165 [INFO] price_checker.py:261 - 尝试使用选择器获取价格详情: //div[contains(@class, '_14omvfj')][.//div[text()='Taxes']]//span[contains(@class, '_1k4xcdh')]
2024-11-10 10:36:48,174 [INFO] price_checker.py:270 - 找到 1 个匹配元素
2024-11-10 10:36:48,185 [INFO] price_checker.py:275 - 找到价格元素: $39 NZD (HTML: <span class="_1k4xcdh">$39&nbsp;NZD</span>)
2024-11-10 10:36:48,192 [INFO] price_checker.py:281 - 父元素文本: taxesshow price breakdown$39 nzd
2024-11-10 10:36:48,192 [INFO] price_checker.py:261 - 尝试使用选择器获取价格详情: //div[contains(@class, '_14omvfj')][.//div[text()='Special offer']]//span[contains(@class, '_1rc8xn5')]
2024-11-10 10:36:48,199 [INFO] price_checker.py:270 - 找到 1 个匹配元素
2024-11-10 10:36:48,204 [INFO] price_checker.py:275 - 找到价格元素: -$43 NZD (HTML: <span class="_1rc8xn5">-$43&nbsp;NZD</span>)
2024-11-10 10:36:48,211 [INFO] price_checker.py:281 - 父元素文本: special offershow price breakdown-$43 nzd
2024-11-10 10:36:48,211 [INFO] price_checker.py:261 - 尝试使用选择器获取价格详情: //div[contains(@class, '_1avmy66')]//span[contains(@class, '_j1kt73')]
2024-11-10 10:36:48,218 [INFO] price_checker.py:270 - 找到 1 个匹配元素
2024-11-10 10:36:48,222 [INFO] price_checker.py:275 - 找到价格元素: $345 NZD (HTML: <span class="_j1kt73">$345&nbsp;NZD</span>)
2024-11-10 10:36:48,231 [WARNING] price_checker.py:301 - 获取父元素文本时出错: Message: no such element: Unable to locate element: {"method":"xpath","selector":"./ancestor::div[contains(@class, '_14omvfj')]"}
  (Session info: chrome=130.0.6723.117); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception
Stacktrace:
	GetHandleVerifier [0x0055EBD3+24307]
	(No symbol) [0x004E8D74]
	(No symbol) [0x003CC323]
	(No symbol) [0x0040DC86]
	(No symbol) [0x0040DECB]
	(No symbol) [0x00403CF1]
	(No symbol) [0x0042FED4]
	(No symbol) [0x00403C14]
	(No symbol) [0x00430124]
	(No symbol) [0x00449579]
	(No symbol) [0x0042FC26]
	(No symbol) [0x0040219C]
	(No symbol) [0x0040311D]
	GetHandleVerifier [0x00808D93+2818227]
	GetHandleVerifier [0x0086542E+3196750]
	GetHandleVerifier [0x0085D9D2+3165426]
	GetHandleVerifier [0x005FDA70+675216]
	(No symbol) [0x004F1B3D]
	(No symbol) [0x004EEA18]
	(No symbol) [0x004EEBB5]
	(No symbol) [0x004E1640]
	BaseThreadInitThunk [0x76167BA9+25]
	RtlInitializeExceptionChain [0x7747C0CB+107]
	RtlClearBits [0x7747C04F+191]

2024-11-10 10:36:48,231 [INFO] price_checker.py:312 - 验证价格信息完整性:
2024-11-10 10:36:48,231 [WARNING] price_checker.py:318 - ✗ cleaning_fee 未获取到
2024-11-10 10:36:48,231 [INFO] price_checker.py:316 - ✓ service_fee: $43 NZD
2024-11-10 10:36:48,231 [WARNING] price_checker.py:318 - ✗ taxes 未获取到
2024-11-10 10:36:48,231 [WARNING] price_checker.py:318 - ✗ total 未获取到
2024-11-10 10:36:48,231 [INFO] price_checker.py:321 - 最终价格信息获取结果:
2024-11-10 10:36:48,232 [INFO] price_checker.py:323 - check_in: 18/11/2024
2024-11-10 10:36:48,232 [INFO] price_checker.py:323 - check_out: 19/11/2024
2024-11-10 10:36:48,232 [INFO] price_checker.py:323 - guests: 3
2024-11-10 10:36:48,232 [INFO] price_checker.py:323 - nightly_price: $216 NZD
2024-11-10 10:36:48,232 [INFO] price_checker.py:323 - cleaning_fee: None
2024-11-10 10:36:48,232 [INFO] price_checker.py:323 - service_fee: $43 NZD
2024-11-10 10:36:48,232 [INFO] price_checker.py:323 - taxes: None
2024-11-10 10:36:48,232 [INFO] price_checker.py:323 - total: None
2024-11-10 10:36:48,232 [INFO] price_checker.py:420 - ✓ 成功获取 18/11/2024 的价格信息
2024-11-10 10:36:48,232 [INFO] price_checker.py:414 - [2/20] 处理日期: 22/11/2024
2024-11-10 10:36:48,232 [INFO] price_checker.py:146 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 10:36:48,232 [INFO] price_checker.py:147 - 入住日期: 22/11/2024, 最小入住晚数: 1
2024-11-10 10:36:48,232 [INFO] price_checker.py:169 - 访问URL: https://www.airbnb.co.nz/rooms/1125096139567330802?check_in=2024-11-22&check_out=2024-11-23&adults=3&children=0&infants=0
2024-11-10 10:36:53,324 [INFO] price_checker.py:176 - 检查页面状态...
2024-11-10 10:36:53,327 [INFO] price_checker.py:178 - 页面状态: complete
2024-11-10 10:36:55,335 [INFO] price_checker.py:191 - 价格容器已加载并可见
2024-11-10 10:36:55,335 [INFO] price_checker.py:200 - 尝试价格选择器: xpath - //div[@data-testid='book-it-default']//span[contains(@class, '_1y74zjx')]
2024-11-10 10:36:55,340 [INFO] price_checker.py:205 - 找到 0 个价格元素
2024-11-10 10:36:55,340 [INFO] price_checker.py:200 - 尝试价格选择器: xpath - //div[@data-testid='book-it-default']//span[contains(@class, '_tyxjp1')]
2024-11-10 10:36:55,344 [INFO] price_checker.py:205 - 找到 0 个价格元素
2024-11-10 10:36:55,344 [INFO] price_checker.py:200 - 尝试价格选择器: css - div._wgmchy div._1k1ce2w span._1qgfaxb1
2024-11-10 10:36:55,348 [INFO] price_checker.py:205 - 找到 1 个价格元素
2024-11-10 10:36:55,360 [INFO] price_checker.py:210 - 找到可见价格元素: $261 NZD 
$217 NZD 
night
$217 NZD per night, originally $261 NZD
2024-11-10 10:36:55,366 [INFO] price_checker.py:223 - 找到每晚价格元素: $261 NZD 
$217 NZD 
night
$217 NZD per night, originally $261 NZD
2024-11-10 10:36:55,366 [INFO] price_checker.py:229 - 成功解析折扣价格: $217 NZD
2024-11-10 10:36:55,366 [INFO] price_checker.py:242 - 开始获取价格详情...
2024-11-10 10:36:55,370 [INFO] price_checker.py:249 - 价格详情容器已加载
2024-11-10 10:36:55,373 [INFO] price_checker.py:261 - 尝试使用选择器获取价格详情: //div[contains(@class, '_14omvfj')][.//div[text()='Cleaning fee']]//span[contains(@class, '_1k4xcdh')]
2024-11-10 10:36:55,377 [INFO] price_checker.py:270 - 找到 1 个匹配元素
2024-11-10 10:36:55,382 [INFO] price_checker.py:275 - 找到价格元素: $90 NZD (HTML: <span class="_1k4xcdh">$90&nbsp;NZD</span>)
2024-11-10 10:36:55,389 [INFO] price_checker.py:281 - 父元素文本: cleaning feeshow price breakdown$90 nzd
2024-11-10 10:36:55,389 [INFO] price_checker.py:261 - 尝试使用选择器获取价格详情: //div[contains(@class, '_14omvfj')][.//div[text()='Airbnb service fee']]//span[contains(@class, '_1k4xcdh')]
2024-11-10 10:36:55,393 [INFO] price_checker.py:270 - 找到 1 个匹配元素
2024-11-10 10:36:55,398 [INFO] price_checker.py:275 - 找到价格元素: $43 NZD (HTML: <span class="_1k4xcdh">$43&nbsp;NZD</span>)
2024-11-10 10:36:55,405 [INFO] price_checker.py:281 - 父元素文本: airbnb service feeshow price breakdown$43 nzd
2024-11-10 10:36:55,405 [INFO] price_checker.py:289 - ✓ 成功设置服务费: $43 NZD
2024-11-10 10:36:55,405 [INFO] price_checker.py:261 - 尝试使用选择器获取价格详情: //div[contains(@class, '_14omvfj')][.//div[text()='Taxes']]//span[contains(@class, '_1k4xcdh')]
2024-11-10 10:36:55,410 [INFO] price_checker.py:270 - 找到 1 个匹配元素
2024-11-10 10:36:55,414 [INFO] price_checker.py:275 - 找到价格元素: $40 NZD (HTML: <span class="_1k4xcdh">$40&nbsp;NZD</span>)
2024-11-10 10:36:55,421 [INFO] price_checker.py:281 - 父元素文本: taxesshow price breakdown$40 nzd
2024-11-10 10:36:55,421 [INFO] price_checker.py:261 - 尝试使用选择器获取价格详情: //div[contains(@class, '_14omvfj')][.//div[text()='Special offer']]//span[contains(@class, '_1rc8xn5')]
2024-11-10 10:36:55,425 [INFO] price_checker.py:270 - 找到 1 个匹配元素
2024-11-10 10:36:55,430 [INFO] price_checker.py:275 - 找到价格元素: -$44 NZD (HTML: <span class="_1rc8xn5">-$44&nbsp;NZD</span>)
2024-11-10 10:36:55,437 [INFO] price_checker.py:281 - 父元素文本: special offershow price breakdown-$44 nzd
2024-11-10 10:36:55,437 [INFO] price_checker.py:261 - 尝试使用选择器获取价格详情: //div[contains(@class, '_1avmy66')]//span[contains(@class, '_j1kt73')]
2024-11-10 10:36:55,442 [INFO] price_checker.py:270 - 找到 1 个匹配元素
2024-11-10 10:36:55,448 [INFO] price_checker.py:275 - 找到价格元素: $347 NZD (HTML: <span class="_j1kt73">$347&nbsp;NZD</span>)
2024-11-10 10:36:55,459 [WARNING] price_checker.py:301 - 获取父元素文本时出错: Message: no such element: Unable to locate element: {"method":"xpath","selector":"./ancestor::div[contains(@class, '_14omvfj')]"}
  (Session info: chrome=130.0.6723.117); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception
Stacktrace:
	GetHandleVerifier [0x0055EBD3+24307]
	(No symbol) [0x004E8D74]
	(No symbol) [0x003CC323]
	(No symbol) [0x0040DC86]
	(No symbol) [0x0040DECB]
	(No symbol) [0x00403CF1]
	(No symbol) [0x0042FED4]
	(No symbol) [0x00403C14]
	(No symbol) [0x00430124]
	(No symbol) [0x00449579]
	(No symbol) [0x0042FC26]
	(No symbol) [0x0040219C]
	(No symbol) [0x0040311D]
	GetHandleVerifier [0x00808D93+2818227]
	GetHandleVerifier [0x0086542E+3196750]
	GetHandleVerifier [0x0085D9D2+3165426]
	GetHandleVerifier [0x005FDA70+675216]
	(No symbol) [0x004F1B3D]
	(No symbol) [0x004EEA18]
	(No symbol) [0x004EEBB5]
	(No symbol) [0x004E1640]
	BaseThreadInitThunk [0x76167BA9+25]
	RtlInitializeExceptionChain [0x7747C0CB+107]
	RtlClearBits [0x7747C04F+191]

2024-11-10 10:36:55,459 [INFO] price_checker.py:312 - 验证价格信息完整性:
2024-11-10 10:36:55,459 [WARNING] price_checker.py:318 - ✗ cleaning_fee 未获取到
2024-11-10 10:36:55,459 [INFO] price_checker.py:316 - ✓ service_fee: $43 NZD
2024-11-10 10:36:55,459 [WARNING] price_checker.py:318 - ✗ taxes 未获取到
2024-11-10 10:36:55,459 [WARNING] price_checker.py:318 - ✗ total 未获取到
2024-11-10 10:36:55,460 [INFO] price_checker.py:321 - 最终价格信息获取结果:
2024-11-10 10:36:55,460 [INFO] price_checker.py:323 - check_in: 22/11/2024
2024-11-10 10:36:55,460 [INFO] price_checker.py:323 - check_out: 23/11/2024
2024-11-10 10:36:55,460 [INFO] price_checker.py:323 - guests: 3
2024-11-10 10:36:55,460 [INFO] price_checker.py:323 - nightly_price: $217 NZD
2024-11-10 10:36:55,460 [INFO] price_checker.py:323 - cleaning_fee: None
2024-11-10 10:36:55,460 [INFO] price_checker.py:323 - service_fee: $43 NZD
2024-11-10 10:36:55,460 [INFO] price_checker.py:323 - taxes: None
2024-11-10 10:36:55,461 [INFO] price_checker.py:323 - total: None
2024-11-10 10:36:55,461 [INFO] price_checker.py:420 - ✓ 成功获取 22/11/2024 的价格信息
2024-11-10 10:36:55,461 [INFO] price_checker.py:414 - [3/20] 处理日期: 26/11/2024
2024-11-10 10:36:55,461 [INFO] price_checker.py:146 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 10:36:55,461 [INFO] price_checker.py:147 - 入住日期: 26/11/2024, 最小入住晚数: 1
2024-11-10 10:36:55,461 [INFO] price_checker.py:169 - 访问URL: https://www.airbnb.co.nz/rooms/1125096139567330802?check_in=2024-11-26&check_out=2024-11-27&adults=3&children=0&infants=0
2024-11-10 10:37:07,213 [INFO] advanced_analyzer.py:262 - === 程序执行完成 ===
