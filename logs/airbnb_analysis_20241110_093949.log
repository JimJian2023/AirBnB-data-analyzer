2024-11-10 09:39:49,041 [INFO] advanced_analyzer.py:192 - === 开始Airbnb数据收集程序 ===
2024-11-10 09:39:49,218 [INFO] advanced_analyzer.py:33 - 成功读取 3 个房间信息
2024-11-10 09:39:49,218 [INFO] advanced_analyzer.py:203 - 生成 3 个URL
2024-11-10 09:39:49,219 [INFO] advanced_analyzer.py:207 - 创建数据目录: data/airbnb_data_20241110_093949
2024-11-10 09:39:49,219 [INFO] advanced_analyzer.py:121 - === 开始批量分析房源 ===
2024-11-10 09:39:50,995 [INFO] advanced_analyzer.py:67 - Chrome WebDriver 初始化成功
2024-11-10 09:39:50,995 [INFO] advanced_analyzer.py:129 - 
处理第 1/3 个房源
2024-11-10 09:39:50,995 [INFO] advanced_analyzer.py:75 - 
开始分析房源: https://www.airbnb.co.nz/rooms/1125096139567330802 (最小入住: 1晚)
2024-11-10 09:39:50,995 [INFO] airbnb_calendar_checker.py:70 - 开始检查房源日历: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 09:39:51,985 [INFO] airbnb_calendar_checker.py:75 - 页面加载中...
2024-11-10 09:39:51,988 [INFO] airbnb_calendar_checker.py:82 - 页面基本加载完成
2024-11-10 09:40:07,195 [INFO] airbnb_calendar_checker.py:120 - 找到日历按钮: //button[contains(@aria-label, 'Choose')]
2024-11-10 09:40:07,198 [INFO] airbnb_calendar_checker.py:134 - 已滚动到日历按钮位置
2024-11-10 09:40:08,198 [INFO] airbnb_calendar_checker.py:139 - 日历按钮已准备就绪
2024-11-10 09:40:09,288 [INFO] airbnb_calendar_checker.py:153 - JavaScript点击日历按钮成功
2024-11-10 09:40:19,454 [INFO] airbnb_calendar_checker.py:184 - 日历内容已加载: //div[contains(@data-testid, 'calendar')]
2024-11-10 09:40:19,467 [INFO] airbnb_calendar_checker.py:199 - 找到 123 个日期单元格
2024-11-10 09:40:19,606 [INFO] airbnb_calendar_checker.py:211 - 找到 123 个日期单元格
2024-11-10 09:40:19,608 [INFO] airbnb_calendar_checker.py:256 - 原始单元格数量: 123
2024-11-10 09:40:19,608 [INFO] airbnb_calendar_checker.py:257 - 去重后数据条数: 123
2024-11-10 09:40:19,608 [INFO] airbnb_calendar_checker.py:258 - 处理的唯一日期数: 123
2024-11-10 09:40:19,608 [INFO] airbnb_calendar_checker.py:262 - 收集到 123 条有效日历数据
2024-11-10 09:40:19,608 [INFO] airbnb_calendar_checker.py:22 - 开始导出数据到Excel...
2024-11-10 09:40:19,608 [INFO] airbnb_calendar_checker.py:32 - 处理房源ID: 1125096139567330802
2024-11-10 09:40:19,608 [INFO] airbnb_calendar_checker.py:37 - 将创建文件: data/airbnb_calendar_1125096139567330802_20241110_094019.xlsx
2024-11-10 09:40:19,609 [INFO] airbnb_calendar_checker.py:41 - 创建DataFrame，共 123 行数据
2024-11-10 09:40:19,636 [INFO] airbnb_calendar_checker.py:52 - 数据已成功导出到Excel文件: data/airbnb_calendar_1125096139567330802_20241110_094019.xlsx
2024-11-10 09:40:19,636 [INFO] airbnb_calendar_checker.py:57 - 文件创建成功，大小: 8.94 KB
2024-11-10 09:40:19,636 [INFO] airbnb_calendar_checker.py:265 - 日历数据已成功导出到: data/airbnb_calendar_1125096139567330802_20241110_094019.xlsx
2024-11-10 09:40:19,636 [INFO] advanced_analyzer.py:84 - 成功获取日历数据: 123 条记录
2024-11-10 09:40:19,636 [INFO] price_checker.py:259 - 开始检查房源价格: https://www.airbnb.co.nz/rooms/1125096139567330802 (最小入住: 1晚)
2024-11-10 09:40:19,636 [INFO] price_checker.py:251 - 找到 20 个可预订日期
2024-11-10 09:40:19,636 [INFO] price_checker.py:275 - [1/20] 处理日期: 18/11/2024
2024-11-10 09:40:19,636 [INFO] price_checker.py:100 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 09:40:19,637 [INFO] price_checker.py:101 - 入住日期: 18/11/2024, 最小入住晚数: 1
2024-11-10 09:40:19,637 [INFO] price_checker.py:105 - 检查页面状态...
2024-11-10 09:40:19,639 [INFO] price_checker.py:107 - 页面状态: complete
2024-11-10 09:40:19,642 [INFO] price_checker.py:111 - 当前页面URL: https://www.airbnb.co.nz/rooms/1125096139567330802?source_impression_id=p3_1731184792_P37T2McYrlHZSwkw
2024-11-10 09:40:19,649 [INFO] price_checker.py:115 - 价格容器存在: True
2024-11-10 09:40:19,649 [ERROR] price_checker.py:189 - 获取价格信息时发生错误: name 'price_selectors' is not defined
2024-11-10 09:40:19,649 [ERROR] price_checker.py:190 - 错误详情: NameError
2024-11-10 09:40:19,652 [ERROR] price_checker.py:191 - 错误堆栈: Traceback (most recent call last):
  File "C:\GitWork\Airbnb data Analyst\price_checker.py", line 118, in get_price_info
    nightly_price_element = find_price_element(driver, price_selectors)
                                                       ^^^^^^^^^^^^^^^
NameError: name 'price_selectors' is not defined

2024-11-10 09:40:19,652 [WARNING] price_checker.py:284 - ✗ 获取 18/11/2024 的价格信息失败
2024-11-10 09:40:19,653 [INFO] price_checker.py:275 - [2/20] 处理日期: 22/11/2024
2024-11-10 09:40:19,653 [INFO] price_checker.py:100 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 09:40:19,653 [INFO] price_checker.py:101 - 入住日期: 22/11/2024, 最小入住晚数: 1
2024-11-10 09:40:19,653 [INFO] price_checker.py:105 - 检查页面状态...
2024-11-10 09:40:19,655 [INFO] price_checker.py:107 - 页面状态: complete
2024-11-10 09:40:19,657 [INFO] price_checker.py:111 - 当前页面URL: https://www.airbnb.co.nz/rooms/1125096139567330802?source_impression_id=p3_1731184792_P37T2McYrlHZSwkw
2024-11-10 09:40:19,662 [INFO] price_checker.py:115 - 价格容器存在: True
2024-11-10 09:40:19,662 [ERROR] price_checker.py:189 - 获取价格信息时发生错误: name 'price_selectors' is not defined
2024-11-10 09:40:19,662 [ERROR] price_checker.py:190 - 错误详情: NameError
2024-11-10 09:40:19,665 [ERROR] price_checker.py:191 - 错误堆栈: Traceback (most recent call last):
  File "C:\GitWork\Airbnb data Analyst\price_checker.py", line 118, in get_price_info
    nightly_price_element = find_price_element(driver, price_selectors)
                                                       ^^^^^^^^^^^^^^^
NameError: name 'price_selectors' is not defined

2024-11-10 09:40:19,665 [WARNING] price_checker.py:284 - ✗ 获取 22/11/2024 的价格信息失败
2024-11-10 09:40:19,665 [INFO] price_checker.py:275 - [3/20] 处理日期: 26/11/2024
2024-11-10 09:40:19,665 [INFO] price_checker.py:100 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 09:40:19,665 [INFO] price_checker.py:101 - 入住日期: 26/11/2024, 最小入住晚数: 1
2024-11-10 09:40:19,665 [INFO] price_checker.py:105 - 检查页面状态...
2024-11-10 09:40:19,667 [INFO] price_checker.py:107 - 页面状态: complete
2024-11-10 09:40:19,669 [INFO] price_checker.py:111 - 当前页面URL: https://www.airbnb.co.nz/rooms/1125096139567330802?source_impression_id=p3_1731184792_P37T2McYrlHZSwkw
2024-11-10 09:40:19,673 [INFO] price_checker.py:115 - 价格容器存在: True
2024-11-10 09:40:19,673 [ERROR] price_checker.py:189 - 获取价格信息时发生错误: name 'price_selectors' is not defined
2024-11-10 09:40:19,673 [ERROR] price_checker.py:190 - 错误详情: NameError
2024-11-10 09:40:19,676 [ERROR] price_checker.py:191 - 错误堆栈: Traceback (most recent call last):
  File "C:\GitWork\Airbnb data Analyst\price_checker.py", line 118, in get_price_info
    nightly_price_element = find_price_element(driver, price_selectors)
                                                       ^^^^^^^^^^^^^^^
NameError: name 'price_selectors' is not defined

2024-11-10 09:40:19,676 [WARNING] price_checker.py:284 - ✗ 获取 26/11/2024 的价格信息失败
2024-11-10 09:40:19,676 [INFO] price_checker.py:275 - [4/20] 处理日期: 27/11/2024
2024-11-10 09:40:19,676 [INFO] price_checker.py:100 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 09:40:19,676 [INFO] price_checker.py:101 - 入住日期: 27/11/2024, 最小入住晚数: 1
2024-11-10 09:40:19,676 [INFO] price_checker.py:105 - 检查页面状态...
2024-11-10 09:40:19,679 [INFO] price_checker.py:107 - 页面状态: complete
2024-11-10 09:40:19,681 [INFO] price_checker.py:111 - 当前页面URL: https://www.airbnb.co.nz/rooms/1125096139567330802?source_impression_id=p3_1731184792_P37T2McYrlHZSwkw
2024-11-10 09:40:19,684 [INFO] price_checker.py:115 - 价格容器存在: True
2024-11-10 09:40:19,685 [ERROR] price_checker.py:189 - 获取价格信息时发生错误: name 'price_selectors' is not defined
2024-11-10 09:40:19,685 [ERROR] price_checker.py:190 - 错误详情: NameError
2024-11-10 09:40:19,687 [ERROR] price_checker.py:191 - 错误堆栈: Traceback (most recent call last):
  File "C:\GitWork\Airbnb data Analyst\price_checker.py", line 118, in get_price_info
    nightly_price_element = find_price_element(driver, price_selectors)
                                                       ^^^^^^^^^^^^^^^
NameError: name 'price_selectors' is not defined

2024-11-10 09:40:19,688 [WARNING] price_checker.py:284 - ✗ 获取 27/11/2024 的价格信息失败
2024-11-10 09:40:19,688 [INFO] price_checker.py:275 - [5/20] 处理日期: 28/11/2024
2024-11-10 09:40:19,688 [INFO] price_checker.py:100 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 09:40:19,688 [INFO] price_checker.py:101 - 入住日期: 28/11/2024, 最小入住晚数: 1
2024-11-10 09:40:19,688 [INFO] price_checker.py:105 - 检查页面状态...
2024-11-10 09:40:19,691 [INFO] price_checker.py:107 - 页面状态: complete
2024-11-10 09:40:19,693 [INFO] price_checker.py:111 - 当前页面URL: https://www.airbnb.co.nz/rooms/1125096139567330802?source_impression_id=p3_1731184792_P37T2McYrlHZSwkw
2024-11-10 09:40:19,697 [INFO] price_checker.py:115 - 价格容器存在: True
2024-11-10 09:40:19,697 [ERROR] price_checker.py:189 - 获取价格信息时发生错误: name 'price_selectors' is not defined
2024-11-10 09:40:19,697 [ERROR] price_checker.py:190 - 错误详情: NameError
2024-11-10 09:40:19,700 [ERROR] price_checker.py:191 - 错误堆栈: Traceback (most recent call last):
  File "C:\GitWork\Airbnb data Analyst\price_checker.py", line 118, in get_price_info
    nightly_price_element = find_price_element(driver, price_selectors)
                                                       ^^^^^^^^^^^^^^^
NameError: name 'price_selectors' is not defined

2024-11-10 09:40:19,700 [WARNING] price_checker.py:284 - ✗ 获取 28/11/2024 的价格信息失败
2024-11-10 09:40:19,700 [INFO] price_checker.py:288 - 已完成 5/20 个日期的处理
2024-11-10 09:40:29,700 [INFO] price_checker.py:275 - [6/20] 处理日期: 03/12/2024
2024-11-10 09:40:29,700 [INFO] price_checker.py:100 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 09:40:29,701 [INFO] price_checker.py:101 - 入住日期: 03/12/2024, 最小入住晚数: 1
2024-11-10 09:40:29,701 [INFO] price_checker.py:105 - 检查页面状态...
2024-11-10 09:40:29,703 [INFO] price_checker.py:107 - 页面状态: complete
2024-11-10 09:40:29,705 [INFO] price_checker.py:111 - 当前页面URL: https://www.airbnb.co.nz/rooms/1125096139567330802?source_impression_id=p3_1731184792_P37T2McYrlHZSwkw
2024-11-10 09:40:29,709 [INFO] price_checker.py:115 - 价格容器存在: True
2024-11-10 09:40:29,709 [ERROR] price_checker.py:189 - 获取价格信息时发生错误: name 'price_selectors' is not defined
2024-11-10 09:40:29,709 [ERROR] price_checker.py:190 - 错误详情: NameError
2024-11-10 09:40:29,712 [ERROR] price_checker.py:191 - 错误堆栈: Traceback (most recent call last):
  File "C:\GitWork\Airbnb data Analyst\price_checker.py", line 118, in get_price_info
    nightly_price_element = find_price_element(driver, price_selectors)
                                                       ^^^^^^^^^^^^^^^
NameError: name 'price_selectors' is not defined

2024-11-10 09:40:29,712 [WARNING] price_checker.py:284 - ✗ 获取 03/12/2024 的价格信息失败
2024-11-10 09:40:29,713 [INFO] price_checker.py:275 - [7/20] 处理日期: 04/12/2024
2024-11-10 09:40:29,713 [INFO] price_checker.py:100 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 09:40:29,713 [INFO] price_checker.py:101 - 入住日期: 04/12/2024, 最小入住晚数: 1
2024-11-10 09:40:29,713 [INFO] price_checker.py:105 - 检查页面状态...
2024-11-10 09:40:29,715 [INFO] price_checker.py:107 - 页面状态: complete
2024-11-10 09:40:29,717 [INFO] price_checker.py:111 - 当前页面URL: https://www.airbnb.co.nz/rooms/1125096139567330802?source_impression_id=p3_1731184792_P37T2McYrlHZSwkw
2024-11-10 09:40:29,721 [INFO] price_checker.py:115 - 价格容器存在: True
2024-11-10 09:40:29,721 [ERROR] price_checker.py:189 - 获取价格信息时发生错误: name 'price_selectors' is not defined
2024-11-10 09:40:29,721 [ERROR] price_checker.py:190 - 错误详情: NameError
2024-11-10 09:40:29,724 [ERROR] price_checker.py:191 - 错误堆栈: Traceback (most recent call last):
  File "C:\GitWork\Airbnb data Analyst\price_checker.py", line 118, in get_price_info
    nightly_price_element = find_price_element(driver, price_selectors)
                                                       ^^^^^^^^^^^^^^^
NameError: name 'price_selectors' is not defined

2024-11-10 09:40:29,724 [WARNING] price_checker.py:284 - ✗ 获取 04/12/2024 的价格信息失败
2024-11-10 09:40:29,724 [INFO] price_checker.py:275 - [8/20] 处理日期: 06/12/2024
2024-11-10 09:40:29,724 [INFO] price_checker.py:100 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 09:40:29,724 [INFO] price_checker.py:101 - 入住日期: 06/12/2024, 最小入住晚数: 1
2024-11-10 09:40:29,724 [INFO] price_checker.py:105 - 检查页面状态...
2024-11-10 09:40:29,726 [INFO] price_checker.py:107 - 页面状态: complete
2024-11-10 09:40:29,728 [INFO] price_checker.py:111 - 当前页面URL: https://www.airbnb.co.nz/rooms/1125096139567330802?source_impression_id=p3_1731184792_P37T2McYrlHZSwkw
2024-11-10 09:40:29,732 [INFO] price_checker.py:115 - 价格容器存在: True
2024-11-10 09:40:29,732 [ERROR] price_checker.py:189 - 获取价格信息时发生错误: name 'price_selectors' is not defined
2024-11-10 09:40:29,732 [ERROR] price_checker.py:190 - 错误详情: NameError
2024-11-10 09:40:29,735 [ERROR] price_checker.py:191 - 错误堆栈: Traceback (most recent call last):
  File "C:\GitWork\Airbnb data Analyst\price_checker.py", line 118, in get_price_info
    nightly_price_element = find_price_element(driver, price_selectors)
                                                       ^^^^^^^^^^^^^^^
NameError: name 'price_selectors' is not defined

2024-11-10 09:40:29,735 [WARNING] price_checker.py:284 - ✗ 获取 06/12/2024 的价格信息失败
2024-11-10 09:40:29,736 [INFO] price_checker.py:275 - [9/20] 处理日期: 14/12/2024
2024-11-10 09:40:29,736 [INFO] price_checker.py:100 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 09:40:29,736 [INFO] price_checker.py:101 - 入住日期: 14/12/2024, 最小入住晚数: 1
2024-11-10 09:40:29,736 [INFO] price_checker.py:105 - 检查页面状态...
2024-11-10 09:40:29,738 [INFO] price_checker.py:107 - 页面状态: complete
2024-11-10 09:40:29,740 [INFO] price_checker.py:111 - 当前页面URL: https://www.airbnb.co.nz/rooms/1125096139567330802?source_impression_id=p3_1731184792_P37T2McYrlHZSwkw
2024-11-10 09:40:29,743 [INFO] price_checker.py:115 - 价格容器存在: True
2024-11-10 09:40:29,743 [ERROR] price_checker.py:189 - 获取价格信息时发生错误: name 'price_selectors' is not defined
2024-11-10 09:40:29,743 [ERROR] price_checker.py:190 - 错误详情: NameError
2024-11-10 09:40:29,746 [ERROR] price_checker.py:191 - 错误堆栈: Traceback (most recent call last):
  File "C:\GitWork\Airbnb data Analyst\price_checker.py", line 118, in get_price_info
    nightly_price_element = find_price_element(driver, price_selectors)
                                                       ^^^^^^^^^^^^^^^
NameError: name 'price_selectors' is not defined

2024-11-10 09:40:29,747 [WARNING] price_checker.py:284 - ✗ 获取 14/12/2024 的价格信息失败
2024-11-10 09:40:29,747 [INFO] price_checker.py:275 - [10/20] 处理日期: 17/12/2024
2024-11-10 09:40:29,747 [INFO] price_checker.py:100 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 09:40:29,747 [INFO] price_checker.py:101 - 入住日期: 17/12/2024, 最小入住晚数: 1
2024-11-10 09:40:29,747 [INFO] price_checker.py:105 - 检查页面状态...
2024-11-10 09:40:29,749 [INFO] price_checker.py:107 - 页面状态: complete
2024-11-10 09:40:29,751 [INFO] price_checker.py:111 - 当前页面URL: https://www.airbnb.co.nz/rooms/1125096139567330802?source_impression_id=p3_1731184792_P37T2McYrlHZSwkw
2024-11-10 09:40:29,754 [INFO] price_checker.py:115 - 价格容器存在: True
2024-11-10 09:40:29,755 [ERROR] price_checker.py:189 - 获取价格信息时发生错误: name 'price_selectors' is not defined
2024-11-10 09:40:29,755 [ERROR] price_checker.py:190 - 错误详情: NameError
2024-11-10 09:40:29,758 [ERROR] price_checker.py:191 - 错误堆栈: Traceback (most recent call last):
  File "C:\GitWork\Airbnb data Analyst\price_checker.py", line 118, in get_price_info
    nightly_price_element = find_price_element(driver, price_selectors)
                                                       ^^^^^^^^^^^^^^^
NameError: name 'price_selectors' is not defined

2024-11-10 09:40:29,758 [WARNING] price_checker.py:284 - ✗ 获取 17/12/2024 的价格信息失败
2024-11-10 09:40:29,758 [INFO] price_checker.py:288 - 已完成 10/20 个日期的处理
2024-11-10 09:40:45,508 [INFO] advanced_analyzer.py:262 - === 程序执行完成 ===
