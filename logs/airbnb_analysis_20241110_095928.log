2024-11-10 09:59:28,089 [INFO] advanced_analyzer.py:192 - === 开始Airbnb数据收集程序 ===
2024-11-10 09:59:28,282 [INFO] advanced_analyzer.py:33 - 成功读取 3 个房间信息
2024-11-10 09:59:28,282 [INFO] advanced_analyzer.py:203 - 生成 3 个URL
2024-11-10 09:59:28,283 [INFO] advanced_analyzer.py:207 - 创建数据目录: data/airbnb_data_20241110_095928
2024-11-10 09:59:28,283 [INFO] advanced_analyzer.py:121 - === 开始批量分析房源 ===
2024-11-10 09:59:30,009 [INFO] advanced_analyzer.py:67 - Chrome WebDriver 初始化成功
2024-11-10 09:59:30,009 [INFO] advanced_analyzer.py:129 - 
处理第 1/3 个房源
2024-11-10 09:59:30,010 [INFO] advanced_analyzer.py:75 - 
开始分析房源: https://www.airbnb.co.nz/rooms/1125096139567330802 (最小入住: 1晚)
2024-11-10 09:59:30,010 [INFO] airbnb_calendar_checker.py:70 - 开始检查房源日历: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 09:59:31,059 [INFO] airbnb_calendar_checker.py:75 - 页面加载中...
2024-11-10 09:59:31,062 [INFO] airbnb_calendar_checker.py:82 - 页面基本加载完成
2024-11-10 09:59:46,251 [INFO] airbnb_calendar_checker.py:120 - 找到日历按钮: //button[contains(@aria-label, 'Choose')]
2024-11-10 09:59:46,254 [INFO] airbnb_calendar_checker.py:134 - 已滚动到日历按钮位置
2024-11-10 09:59:47,254 [INFO] airbnb_calendar_checker.py:139 - 日历按钮已准备就绪
2024-11-10 09:59:48,345 [INFO] airbnb_calendar_checker.py:153 - JavaScript点击日历按钮成功
2024-11-10 09:59:58,559 [INFO] airbnb_calendar_checker.py:184 - 日历内容已加载: //div[contains(@data-testid, 'calendar')]
2024-11-10 09:59:58,571 [INFO] airbnb_calendar_checker.py:199 - 找到 123 个日期单元格
2024-11-10 09:59:58,698 [INFO] airbnb_calendar_checker.py:211 - 找到 123 个日期单元格
2024-11-10 09:59:58,699 [INFO] airbnb_calendar_checker.py:256 - 原始单元格数量: 123
2024-11-10 09:59:58,700 [INFO] airbnb_calendar_checker.py:257 - 去重后数据条数: 123
2024-11-10 09:59:58,700 [INFO] airbnb_calendar_checker.py:258 - 处理的唯一日期数: 123
2024-11-10 09:59:58,700 [INFO] airbnb_calendar_checker.py:262 - 收集到 123 条有效日历数据
2024-11-10 09:59:58,700 [INFO] airbnb_calendar_checker.py:22 - 开始导出数据到Excel...
2024-11-10 09:59:58,700 [INFO] airbnb_calendar_checker.py:32 - 处理房源ID: 1125096139567330802
2024-11-10 09:59:58,700 [INFO] airbnb_calendar_checker.py:37 - 将创建文件: data/airbnb_calendar_1125096139567330802_20241110_095958.xlsx
2024-11-10 09:59:58,701 [INFO] airbnb_calendar_checker.py:41 - 创建DataFrame，共 123 行数据
2024-11-10 09:59:58,726 [INFO] airbnb_calendar_checker.py:52 - 数据已成功导出到Excel文件: data/airbnb_calendar_1125096139567330802_20241110_095958.xlsx
2024-11-10 09:59:58,726 [INFO] airbnb_calendar_checker.py:57 - 文件创建成功，大小: 8.94 KB
2024-11-10 09:59:58,726 [INFO] airbnb_calendar_checker.py:265 - 日历数据已成功导出到: data/airbnb_calendar_1125096139567330802_20241110_095958.xlsx
2024-11-10 09:59:58,726 [INFO] advanced_analyzer.py:84 - 成功获取日历数据: 123 条记录
2024-11-10 09:59:58,727 [INFO] price_checker.py:424 - 开始检查房源价格: https://www.airbnb.co.nz/rooms/1125096139567330802 (最小入住: 1晚)
2024-11-10 09:59:58,727 [INFO] price_checker.py:416 - 找到 20 个可预订日期
2024-11-10 09:59:58,727 [INFO] price_checker.py:440 - [1/20] 处理日期: 18/11/2024
2024-11-10 09:59:58,727 [INFO] price_checker.py:149 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 09:59:58,727 [INFO] price_checker.py:150 - 入住日期: 18/11/2024, 最小入住晚数: 1
2024-11-10 09:59:58,727 [INFO] price_checker.py:172 - 访问URL: https://www.airbnb.co.nz/rooms/1125096139567330802?check_in=2024-11-18&check_out=2024-11-19&adults=3&children=0&infants=0
2024-11-10 10:00:03,878 [INFO] price_checker.py:179 - 检查页面状态...
2024-11-10 10:00:03,881 [INFO] price_checker.py:181 - 页面状态: complete
2024-11-10 10:00:05,892 [INFO] price_checker.py:194 - 价格容器已加载并可见
2024-11-10 10:00:05,892 [INFO] price_checker.py:203 - 尝试价格选择器: xpath - //div[@data-testid='book-it-default']//span[contains(@class, '_1y74zjx')]
2024-11-10 10:00:05,899 [INFO] price_checker.py:208 - 找到 0 个价格元素
2024-11-10 10:00:05,899 [INFO] price_checker.py:203 - 尝试价格选择器: xpath - //div[@data-testid='book-it-default']//span[contains(@class, '_tyxjp1')]
2024-11-10 10:00:05,906 [INFO] price_checker.py:208 - 找到 0 个价格元素
2024-11-10 10:00:05,906 [INFO] price_checker.py:203 - 尝试价格选择器: css - div._wgmchy div._1k1ce2w span._1qgfaxb1
2024-11-10 10:00:05,912 [INFO] price_checker.py:208 - 找到 1 个价格元素
2024-11-10 10:00:05,928 [INFO] price_checker.py:213 - 找到可见价格元素: $259 NZD 
$216 NZD 
night
$216 NZD per night, originally $259 NZD
2024-11-10 10:00:05,934 [INFO] price_checker.py:226 - 找到每晚价格元素: $259 NZD 
$216 NZD 
night
$216 NZD per night, originally $259 NZD
2024-11-10 10:00:05,934 [INFO] price_checker.py:232 - 成功解析价格: $259 NZD
2024-11-10 10:00:05,934 [INFO] price_checker.py:247 - 尝试直接获取价格详情...
2024-11-10 10:00:05,978 [INFO] price_checker.py:284 - 直接获取价格详情失败，尝试点击展开按钮...
2024-11-10 10:00:05,985 [INFO] price_checker.py:291 - 找到 1 个匹配元素
2024-11-10 10:00:05,995 [INFO] price_checker.py:291 - 找到 1 个匹配元素
2024-11-10 10:00:06,005 [INFO] price_checker.py:291 - 找到 1 个匹配元素
2024-11-10 10:00:06,015 [INFO] price_checker.py:291 - 找到 1 个匹配元素
2024-11-10 10:00:06,026 [INFO] price_checker.py:291 - 找到 5 个匹配元素
2024-11-10 10:00:06,051 [INFO] price_checker.py:291 - 找到 5 个匹配元素
2024-11-10 10:00:06,070 [WARNING] price_checker.py:344 - 未找到价格详情按钮
2024-11-10 10:00:06,070 [INFO] price_checker.py:347 - 最终价格信息获取结果:
2024-11-10 10:00:06,070 [INFO] price_checker.py:349 - check_in: 18/11/2024
2024-11-10 10:00:06,070 [INFO] price_checker.py:349 - check_out: 19/11/2024
2024-11-10 10:00:06,070 [INFO] price_checker.py:349 - guests: 3
2024-11-10 10:00:06,070 [INFO] price_checker.py:349 - nightly_price: $259 NZD
2024-11-10 10:00:06,070 [INFO] price_checker.py:349 - cleaning_fee: None
2024-11-10 10:00:06,070 [INFO] price_checker.py:349 - service_fee: None
2024-11-10 10:00:06,071 [INFO] price_checker.py:349 - taxes: None
2024-11-10 10:00:06,071 [INFO] price_checker.py:349 - total: None
2024-11-10 10:00:06,071 [INFO] price_checker.py:446 - ✓ 成功获取 18/11/2024 的价格信息
2024-11-10 10:00:06,071 [INFO] price_checker.py:440 - [2/20] 处理日期: 22/11/2024
2024-11-10 10:00:06,071 [INFO] price_checker.py:149 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 10:00:06,071 [INFO] price_checker.py:150 - 入住日期: 22/11/2024, 最小入住晚数: 1
2024-11-10 10:00:06,071 [INFO] price_checker.py:172 - 访问URL: https://www.airbnb.co.nz/rooms/1125096139567330802?check_in=2024-11-22&check_out=2024-11-23&adults=3&children=0&infants=0
2024-11-10 10:00:11,166 [INFO] price_checker.py:179 - 检查页面状态...
2024-11-10 10:00:11,169 [INFO] price_checker.py:181 - 页面状态: complete
2024-11-10 10:00:13,177 [INFO] price_checker.py:194 - 价格容器已加载并可见
2024-11-10 10:00:13,178 [INFO] price_checker.py:203 - 尝试价格选择器: xpath - //div[@data-testid='book-it-default']//span[contains(@class, '_1y74zjx')]
2024-11-10 10:00:13,182 [INFO] price_checker.py:208 - 找到 0 个价格元素
2024-11-10 10:00:13,182 [INFO] price_checker.py:203 - 尝试价格选择器: xpath - //div[@data-testid='book-it-default']//span[contains(@class, '_tyxjp1')]
2024-11-10 10:00:13,186 [INFO] price_checker.py:208 - 找到 0 个价格元素
2024-11-10 10:00:13,186 [INFO] price_checker.py:203 - 尝试价格选择器: css - div._wgmchy div._1k1ce2w span._1qgfaxb1
2024-11-10 10:00:13,190 [INFO] price_checker.py:208 - 找到 1 个价格元素
2024-11-10 10:00:13,201 [INFO] price_checker.py:213 - 找到可见价格元素: $261 NZD 
$217 NZD 
night
$217 NZD per night, originally $261 NZD
2024-11-10 10:00:13,206 [INFO] price_checker.py:226 - 找到每晚价格元素: $261 NZD 
$217 NZD 
night
$217 NZD per night, originally $261 NZD
2024-11-10 10:00:13,207 [INFO] price_checker.py:232 - 成功解析价格: $261 NZD
2024-11-10 10:00:13,207 [INFO] price_checker.py:247 - 尝试直接获取价格详情...
2024-11-10 10:00:13,236 [INFO] price_checker.py:284 - 直接获取价格详情失败，尝试点击展开按钮...
2024-11-10 10:00:13,240 [INFO] price_checker.py:291 - 找到 1 个匹配元素
2024-11-10 10:00:13,248 [INFO] price_checker.py:291 - 找到 1 个匹配元素
2024-11-10 10:00:13,255 [INFO] price_checker.py:291 - 找到 1 个匹配元素
2024-11-10 10:00:13,262 [INFO] price_checker.py:291 - 找到 1 个匹配元素
2024-11-10 10:00:13,270 [INFO] price_checker.py:291 - 找到 5 个匹配元素
2024-11-10 10:00:13,292 [INFO] price_checker.py:291 - 找到 5 个匹配元素
2024-11-10 10:00:13,310 [WARNING] price_checker.py:344 - 未找到价格详情按钮
2024-11-10 10:00:13,311 [INFO] price_checker.py:347 - 最终价格信息获取结果:
2024-11-10 10:00:13,311 [INFO] price_checker.py:349 - check_in: 22/11/2024
2024-11-10 10:00:13,311 [INFO] price_checker.py:349 - check_out: 23/11/2024
2024-11-10 10:00:13,311 [INFO] price_checker.py:349 - guests: 3
2024-11-10 10:00:13,311 [INFO] price_checker.py:349 - nightly_price: $261 NZD
2024-11-10 10:00:13,311 [INFO] price_checker.py:349 - cleaning_fee: None
2024-11-10 10:00:13,311 [INFO] price_checker.py:349 - service_fee: None
2024-11-10 10:00:13,311 [INFO] price_checker.py:349 - taxes: None
2024-11-10 10:00:13,311 [INFO] price_checker.py:349 - total: None
2024-11-10 10:00:13,311 [INFO] price_checker.py:446 - ✓ 成功获取 22/11/2024 的价格信息
2024-11-10 10:00:13,311 [INFO] price_checker.py:440 - [3/20] 处理日期: 26/11/2024
2024-11-10 10:00:13,311 [INFO] price_checker.py:149 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 10:00:13,312 [INFO] price_checker.py:150 - 入住日期: 26/11/2024, 最小入住晚数: 1
2024-11-10 10:00:13,312 [INFO] price_checker.py:172 - 访问URL: https://www.airbnb.co.nz/rooms/1125096139567330802?check_in=2024-11-26&check_out=2024-11-27&adults=3&children=0&infants=0
2024-11-10 10:00:18,402 [INFO] price_checker.py:179 - 检查页面状态...
2024-11-10 10:00:18,405 [INFO] price_checker.py:181 - 页面状态: complete
2024-11-10 10:00:20,414 [INFO] price_checker.py:194 - 价格容器已加载并可见
2024-11-10 10:00:20,414 [INFO] price_checker.py:203 - 尝试价格选择器: xpath - //div[@data-testid='book-it-default']//span[contains(@class, '_1y74zjx')]
2024-11-10 10:00:20,419 [INFO] price_checker.py:208 - 找到 0 个价格元素
2024-11-10 10:00:20,419 [INFO] price_checker.py:203 - 尝试价格选择器: xpath - //div[@data-testid='book-it-default']//span[contains(@class, '_tyxjp1')]
2024-11-10 10:00:20,423 [INFO] price_checker.py:208 - 找到 0 个价格元素
2024-11-10 10:00:20,423 [INFO] price_checker.py:203 - 尝试价格选择器: css - div._wgmchy div._1k1ce2w span._1qgfaxb1
2024-11-10 10:00:20,427 [INFO] price_checker.py:208 - 找到 1 个价格元素
2024-11-10 10:00:20,437 [INFO] price_checker.py:213 - 找到可见价格元素: $254 NZD 
$201 NZD 
night
$201 NZD per night, originally $254 NZD
2024-11-10 10:00:20,443 [INFO] price_checker.py:226 - 找到每晚价格元素: $254 NZD 
$201 NZD 
night
$201 NZD per night, originally $254 NZD
2024-11-10 10:00:20,443 [INFO] price_checker.py:232 - 成功解析价格: $254 NZD
2024-11-10 10:00:20,444 [INFO] price_checker.py:247 - 尝试直接获取价格详情...
2024-11-10 10:00:20,474 [INFO] price_checker.py:284 - 直接获取价格详情失败，尝试点击展开按钮...
2024-11-10 10:00:20,478 [INFO] price_checker.py:291 - 找到 1 个匹配元素
2024-11-10 10:00:20,486 [INFO] price_checker.py:291 - 找到 1 个匹配元素
2024-11-10 10:00:20,493 [INFO] price_checker.py:291 - 找到 1 个匹配元素
2024-11-10 10:00:20,501 [INFO] price_checker.py:291 - 找到 1 个匹配元素
2024-11-10 10:00:20,509 [INFO] price_checker.py:291 - 找到 5 个匹配元素
2024-11-10 10:00:20,542 [INFO] price_checker.py:291 - 找到 5 个匹配元素
2024-11-10 10:00:20,570 [WARNING] price_checker.py:344 - 未找到价格详情按钮
2024-11-10 10:00:20,570 [INFO] price_checker.py:347 - 最终价格信息获取结果:
2024-11-10 10:00:20,570 [INFO] price_checker.py:349 - check_in: 26/11/2024
2024-11-10 10:00:20,570 [INFO] price_checker.py:349 - check_out: 27/11/2024
2024-11-10 10:00:20,570 [INFO] price_checker.py:349 - guests: 3
2024-11-10 10:00:20,570 [INFO] price_checker.py:349 - nightly_price: $254 NZD
2024-11-10 10:00:20,570 [INFO] price_checker.py:349 - cleaning_fee: None
2024-11-10 10:00:20,570 [INFO] price_checker.py:349 - service_fee: None
2024-11-10 10:00:20,570 [INFO] price_checker.py:349 - taxes: None
2024-11-10 10:00:20,570 [INFO] price_checker.py:349 - total: None
2024-11-10 10:00:20,570 [INFO] price_checker.py:446 - ✓ 成功获取 26/11/2024 的价格信息
2024-11-10 10:00:20,570 [INFO] price_checker.py:440 - [4/20] 处理日期: 27/11/2024
2024-11-10 10:00:20,571 [INFO] price_checker.py:149 - 开始获取价格信息: https://www.airbnb.co.nz/rooms/1125096139567330802
2024-11-10 10:00:20,571 [INFO] price_checker.py:150 - 入住日期: 27/11/2024, 最小入住晚数: 1
2024-11-10 10:00:20,571 [INFO] price_checker.py:172 - 访问URL: https://www.airbnb.co.nz/rooms/1125096139567330802?check_in=2024-11-27&check_out=2024-11-28&adults=3&children=0&infants=0
2024-11-10 10:00:41,564 [INFO] advanced_analyzer.py:188 - 浏览器已关闭
2024-11-10 10:00:41,564 [INFO] advanced_analyzer.py:262 - === 程序执行完成 ===
