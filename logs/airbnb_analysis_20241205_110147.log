2024-12-05 11:01:47,511 [INFO] data_export.py:53 - 创建基础目录: data
2024-12-05 11:01:47,511 [INFO] data_export.py:58 - 创建date目录: data\by_date
2024-12-05 11:01:47,511 [INFO] data_export.py:58 - 创建room目录: data\by_room
2024-12-05 11:01:47,515 [INFO] advanced_analyzer.py:420 - === 开始Airbnb数据收集程序 ===
2024-12-05 11:01:47,696 [INFO] advanced_analyzer.py:101 - 成功读取 1 个房间ID
2024-12-05 11:01:47,696 [INFO] advanced_analyzer.py:431 - 生成 1 个URL
2024-12-05 11:01:47,696 [INFO] advanced_analyzer.py:435 - 创建数据目录: data/airbnb_data_20241205_110147
2024-12-05 11:01:47,696 [INFO] advanced_analyzer.py:291 - === 开始批量分析房源 ===
2024-12-05 11:01:47,723 [INFO] bit_browser_manager.py:103 - 活动浏览器响应: {
  "success": true,
  "data": {
    "34dc763412e34341a759c1ef1ec38580": 22328
  }
}
2024-12-05 11:01:48,796 [INFO] bit_browser_manager.py:128 - 找到 1 个活动浏览器
2024-12-05 11:01:49,356 [INFO] bit_browser_manager.py:53 - 开始设置语言偏好
2024-12-05 11:01:49,359 [INFO] bit_browser_manager.py:65 - 设置语言为: en
2024-12-05 11:01:49,362 [INFO] bit_browser_manager.py:86 - 成功设置 locale cookie
2024-12-05 11:01:49,364 [INFO] bit_browser_manager.py:86 - 成功设置 currency cookie
2024-12-05 11:01:49,364 [INFO] advanced_analyzer.py:309 - 成功连接到浏览器: 34dc763412e34341a759c1ef1ec38580
2024-12-05 11:01:49,365 [INFO] advanced_analyzer.py:318 - 设置并发线程数: 1
2024-12-05 11:01:49,365 [INFO] advanced_analyzer.py:333 - 
=== URL分配情况 ===
2024-12-05 11:01:49,365 [INFO] advanced_analyzer.py:335 - 线程 1 分配到 1 个URL:
2024-12-05 11:01:49,365 [INFO] advanced_analyzer.py:338 -   - Room ID: 837352260137971048
2024-12-05 11:01:49,365 [INFO] advanced_analyzer.py:200 - 初始化 AdvancedAnalyzer 实例
2024-12-05 11:01:49,365 [INFO] advanced_analyzer.py:204 - === 进入 analyze_listing 方法 ===
2024-12-05 11:01:49,366 [INFO] advanced_analyzer.py:205 - 参数: browser_id=34dc763412e34341a759c1ef1ec38580, url=https://www.airbnb.co.nz/rooms/837352260137971048
2024-12-05 11:01:49,366 [INFO] advanced_analyzer.py:214 - 解析得到 Room ID: 837352260137971048
2024-12-05 11:01:49,366 [INFO] advanced_analyzer.py:217 - 开始获取日历数据
2024-12-05 11:01:49,366 [INFO] airbnb_calendar_checker.py:27 - 开始检查房源日历: https://www.airbnb.co.nz/rooms/837352260137971048
2024-12-05 11:01:49,366 [INFO] bit_browser_manager.py:53 - 开始设置语言偏好
2024-12-05 11:01:49,366 [INFO] bit_browser_manager.py:58 - 该浏览器实例已设置过语言，跳过设置
2024-12-05 11:01:58,262 [INFO] airbnb_calendar_checker.py:35 - 页面加载中...
2024-12-05 11:02:10,416 [WARNING] bit_browser_manager.py:333 - 未找到翻译提示框关闭按钮
2024-12-05 11:02:10,419 [INFO] airbnb_calendar_checker.py:45 - 页面基本加载完成
2024-12-05 11:02:28,589 [INFO] airbnb_calendar_checker.py:83 - 找到日历按钮: //button[contains(@aria-label, 'Choose')]
2024-12-05 11:02:28,592 [INFO] airbnb_calendar_checker.py:97 - 已滚动到日历按钮位置
2024-12-05 11:02:29,593 [INFO] airbnb_calendar_checker.py:102 - 日历按钮已准备就绪
2024-12-05 11:02:29,740 [INFO] airbnb_calendar_checker.py:111 - 直接点击日历按钮成功
2024-12-05 11:02:42,892 [INFO] airbnb_calendar_checker.py:147 - 日历内容已加载: //div[contains(@data-testid, 'calendar')]
2024-12-05 11:02:42,904 [INFO] airbnb_calendar_checker.py:162 - 找到 120 个日期单元格
2024-12-05 11:02:43,006 [INFO] airbnb_calendar_checker.py:174 - 找到 120 个日期单元格
2024-12-05 11:02:43,007 [INFO] airbnb_calendar_checker.py:219 - 原始单元格数量: 120
2024-12-05 11:02:43,007 [INFO] airbnb_calendar_checker.py:220 - 去重后数据条数: 120
2024-12-05 11:02:43,007 [INFO] airbnb_calendar_checker.py:221 - 处理的唯一日期数: 120
2024-12-05 11:02:43,008 [INFO] airbnb_calendar_checker.py:225 - 收集到 120 条有效日历数据
2024-12-05 11:02:43,035 [INFO] data_export.py:140 - calendar数据已导出到日期目录: data\by_date\calendar_837352260137971048_20241205_110243.xlsx
2024-12-05 11:02:43,058 [INFO] data_export.py:145 - calendar数据已导出到房间目录: data\by_room\837352260137971048\calendar_20241205_110243.xlsx
2024-12-05 11:02:43,058 [INFO] airbnb_calendar_checker.py:229 - 日历数据已成功导出到: data\by_date\calendar_837352260137971048_20241205_110243.xlsx
2024-12-05 11:02:43,058 [ERROR] advanced_analyzer.py:232 - 处理 Room ID 837352260137971048 时发生错误: too many values to unpack (expected 2)
2024-12-05 11:02:43,058 [ERROR] advanced_analyzer.py:233 - 错误类型: ValueError
2024-12-05 11:02:43,058 [ERROR] advanced_analyzer.py:234 - 错误堆栈:
Traceback (most recent call last):
  File "C:\GitWork\AirBnB-data-analyzer\advanced_analyzer.py", line 218, in analyze_listing
    calendar_data, excel_file = check_calendar_availability(url, driver)
    ^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)
2024-12-05 11:02:43,059 [INFO] advanced_analyzer.py:451 - === 程序执行完成 ===
