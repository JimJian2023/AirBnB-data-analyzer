2024-12-05 10:23:26,416 [INFO] data_export.py:53 - 创建基础目录: data
2024-12-05 10:23:26,417 [INFO] data_export.py:58 - 创建date目录: data\by_date
2024-12-05 10:23:26,417 [INFO] data_export.py:58 - 创建room目录: data\by_room
2024-12-05 10:23:26,423 [INFO] advanced_analyzer.py:396 - === 开始Airbnb数据收集程序 ===
2024-12-05 10:23:26,604 [INFO] advanced_analyzer.py:101 - 成功读取 2 个房间ID
2024-12-05 10:23:26,604 [INFO] advanced_analyzer.py:407 - 生成 2 个URL
2024-12-05 10:23:26,604 [INFO] advanced_analyzer.py:411 - 创建数据目录: data/airbnb_data_20241205_102326
2024-12-05 10:23:26,605 [INFO] advanced_analyzer.py:233 - === 开始批量分析房源 ===
2024-12-05 10:23:26,605 [INFO] advanced_analyzer.py:242 - 设置并发线程数: 1
2024-12-05 10:23:26,631 [INFO] bit_browser_manager.py:94 - 活动浏览器响应: {
  "success": true,
  "data": {
    "34dc763412e34341a759c1ef1ec38580": 9600
  }
}
2024-12-05 10:23:27,513 [INFO] bit_browser_manager.py:119 - 找到 1 个活动浏览器
2024-12-05 10:23:27,513 [INFO] advanced_analyzer.py:258 - 
=== 可用的浏览器实例 ===
2024-12-05 10:23:27,513 [INFO] advanced_analyzer.py:260 - ID: 34dc763412e34341a759c1ef1ec38580
2024-12-05 10:23:27,513 [INFO] advanced_analyzer.py:261 - 名称: AirBnB01
2024-12-05 10:23:27,513 [INFO] advanced_analyzer.py:262 - 备注: 
2024-12-05 10:23:27,513 [INFO] advanced_analyzer.py:263 - PID: 9600

2024-12-05 10:23:27,514 [INFO] advanced_analyzer.py:278 - 
=== URL分配情况 ===
2024-12-05 10:23:27,514 [INFO] advanced_analyzer.py:280 - 线程 1 分配到 2 个URL:
2024-12-05 10:23:27,514 [INFO] advanced_analyzer.py:283 -   - Room ID: 837352260137971048
2024-12-05 10:23:27,514 [INFO] advanced_analyzer.py:283 -   - Room ID: 43435162
2024-12-05 10:23:27,514 [INFO] advanced_analyzer.py:294 - 线程 19728 (#1) 使用浏览器 34dc763412e34341a759c1ef1ec38580
2024-12-05 10:23:30,626 [INFO] bit_browser_manager.py:63 - 成功设置 locale cookie
2024-12-05 10:23:30,636 [INFO] bit_browser_manager.py:63 - 成功设置 currency cookie
2024-12-05 10:23:30,659 [INFO] advanced_analyzer.py:307 - 线程 #1 开始处理 Room ID: 837352260137971048
2024-12-05 10:23:32,647 [INFO] bit_browser_manager.py:63 - 成功设置 locale cookie
2024-12-05 10:23:32,690 [INFO] bit_browser_manager.py:63 - 成功设置 currency cookie
2024-12-05 10:23:32,712 [ERROR] bit_browser_manager.py:82 - 设置语言偏好时发生错误: Message: unknown error: unhandled inspector error: {"code":-32000,"message":"Another locale override is already in effect"}
  (Session info: chrome=126.0.6478.255)
Stacktrace:
	GetHandleVerifier [0x0031FD33+27651]
	(No symbol) [0x002B5554]
	(No symbol) [0x001B1ADF]
	(No symbol) [0x0019CF7D]
	(No symbol) [0x0019BC03]
	(No symbol) [0x0019C35D]
	(No symbol) [0x0019C2F8]
	(No symbol) [0x001B4804]
	(No symbol) [0x00237381]
	(No symbol) [0x0021390C]
	(No symbol) [0x0022CA7D]
	(No symbol) [0x002136A6]
	(No symbol) [0x001E74E1]
	(No symbol) [0x001E805D]
	GetHandleVerifier [0x005D6613+2872547]
	GetHandleVerifier [0x0062BADD+3221933]
	GetHandleVerifier [0x003A2A94+563556]
	GetHandleVerifier [0x003A9DCC+593052]
	(No symbol) [0x002BE3A4]
	(No symbol) [0x002BAE08]
	(No symbol) [0x002BAFA7]
	(No symbol) [0x002AD0AE]
	BaseThreadInitThunk [0x76AD7BA9+25]
	RtlInitializeExceptionChain [0x77ADC0CB+107]
	RtlClearBits [0x77ADC04F+191]
	(No symbol) [0x00000000]

2024-12-05 10:23:32,712 [INFO] bit_browser_manager.py:251 - 正在导航到: https://www.airbnb.co.nz/rooms/837352260137971048
2024-12-05 10:23:32,819 [INFO] bit_browser_manager.py:259 - 成功加载页面: https://www.airbnb.co.nz/rooms/837352260137971048
2024-12-05 10:23:32,820 [INFO] advanced_analyzer.py:198 - 
开始分析房源: https://www.airbnb.co.nz/rooms/837352260137971048
2024-12-05 10:23:32,820 [INFO] airbnb_calendar_checker.py:27 - 开始检查房源日历: https://www.airbnb.co.nz/rooms/837352260137971048
2024-12-05 10:23:32,826 [INFO] bit_browser_manager.py:63 - 成功设置 locale cookie
2024-12-05 10:23:32,828 [INFO] bit_browser_manager.py:63 - 成功设置 currency cookie
2024-12-05 10:23:32,829 [ERROR] bit_browser_manager.py:82 - 设置语言偏好时发生错误: Message: unknown error: unhandled inspector error: {"code":-32000,"message":"Another locale override is already in effect"}
  (Session info: chrome=126.0.6478.255)
Stacktrace:
	GetHandleVerifier [0x0031FD33+27651]
	(No symbol) [0x002B5554]
	(No symbol) [0x001B1ADF]
	(No symbol) [0x0019CF7D]
	(No symbol) [0x0019BC03]
	(No symbol) [0x0019C35D]
	(No symbol) [0x0019C2F8]
	(No symbol) [0x001B4804]
	(No symbol) [0x00237381]
	(No symbol) [0x0021390C]
	(No symbol) [0x0022CA7D]
	(No symbol) [0x002136A6]
	(No symbol) [0x001E74E1]
	(No symbol) [0x001E805D]
	GetHandleVerifier [0x005D6613+2872547]
	GetHandleVerifier [0x0062BADD+3221933]
	GetHandleVerifier [0x003A2A94+563556]
	GetHandleVerifier [0x003A9DCC+593052]
	(No symbol) [0x002BE3A4]
	(No symbol) [0x002BAE08]
	(No symbol) [0x002BAFA7]
	(No symbol) [0x002AD0AE]
	BaseThreadInitThunk [0x76AD7BA9+25]
	RtlInitializeExceptionChain [0x77ADC0CB+107]
	RtlClearBits [0x77ADC04F+191]
	(No symbol) [0x00000000]

2024-12-05 10:23:32,943 [INFO] airbnb_calendar_checker.py:35 - 页面加载中...
2024-12-05 10:24:13,079 [WARNING] bit_browser_manager.py:317 - 未找到翻译提示框关闭按钮
2024-12-05 10:24:13,081 [INFO] airbnb_calendar_checker.py:45 - 页面基本加载完成
2024-12-05 10:25:13,231 [INFO] airbnb_calendar_checker.py:83 - 找到日历按钮: //button[contains(@aria-label, 'Choose')]
2024-12-05 10:25:13,234 [INFO] airbnb_calendar_checker.py:97 - 已滚动到日历按钮位置
2024-12-05 10:25:14,235 [INFO] airbnb_calendar_checker.py:102 - 日历按钮已准备就绪
2024-12-05 10:25:14,379 [INFO] airbnb_calendar_checker.py:111 - 直接点击日历按钮成功
2024-12-05 10:25:34,479 [INFO] airbnb_calendar_checker.py:147 - 日历内容已加载: //div[contains(@data-testid, 'calendar')]
2024-12-05 10:25:34,491 [INFO] airbnb_calendar_checker.py:162 - 找到 120 个日期单元格
2024-12-05 10:25:34,594 [INFO] airbnb_calendar_checker.py:174 - 找到 120 个日期单元格
2024-12-05 10:25:34,595 [INFO] airbnb_calendar_checker.py:219 - 原始单元格数量: 120
2024-12-05 10:25:34,595 [INFO] airbnb_calendar_checker.py:220 - 去重后数据条数: 120
2024-12-05 10:25:34,595 [INFO] airbnb_calendar_checker.py:221 - 处理的唯一日期数: 120
2024-12-05 10:25:34,595 [INFO] airbnb_calendar_checker.py:225 - 收集到 120 条有效日历数据
2024-12-05 10:25:34,621 [INFO] data_export.py:140 - calendar数据已导出到日期目录: data\by_date\calendar_837352260137971048_20241205_102534.xlsx
2024-12-05 10:25:34,643 [INFO] data_export.py:145 - calendar数据已导出到房间目录: data\by_room\837352260137971048\calendar_20241205_102534.xlsx
2024-12-05 10:25:34,643 [INFO] airbnb_calendar_checker.py:229 - 日历数据已成功导出到: data\by_date\calendar_837352260137971048_20241205_102534.xlsx
2024-12-05 10:25:34,643 [INFO] advanced_analyzer.py:207 - 成功获取日历数据: 120 条记录
2024-12-05 10:25:34,643 [ERROR] advanced_analyzer.py:227 - 分析房源时发生错误: check_room_price() takes 2 positional arguments but 3 were given
2024-12-05 10:25:34,709 [INFO] bit_browser_manager.py:343 - 成功关闭标签页
2024-12-05 10:25:34,709 [INFO] advanced_analyzer.py:307 - 线程 #1 开始处理 Room ID: 43435162
2024-12-05 10:25:36,444 [INFO] bit_browser_manager.py:63 - 成功设置 locale cookie
2024-12-05 10:25:36,448 [INFO] bit_browser_manager.py:63 - 成功设置 currency cookie
2024-12-05 10:25:36,454 [ERROR] bit_browser_manager.py:82 - 设置语言偏好时发生错误: Message: unknown error: unhandled inspector error: {"code":-32000,"message":"Another locale override is already in effect"}
  (Session info: chrome=126.0.6478.255)
Stacktrace:
	GetHandleVerifier [0x0031FD33+27651]
	(No symbol) [0x002B5554]
	(No symbol) [0x001B1ADF]
	(No symbol) [0x0019CF7D]
	(No symbol) [0x0019BC03]
	(No symbol) [0x0019C35D]
	(No symbol) [0x0019C2F8]
	(No symbol) [0x001B4804]
	(No symbol) [0x00237381]
	(No symbol) [0x0021390C]
	(No symbol) [0x0022CA7D]
	(No symbol) [0x002136A6]
	(No symbol) [0x001E74E1]
	(No symbol) [0x001E805D]
	GetHandleVerifier [0x005D6613+2872547]
	GetHandleVerifier [0x0062BADD+3221933]
	GetHandleVerifier [0x003A2A94+563556]
	GetHandleVerifier [0x003A9DCC+593052]
	(No symbol) [0x002BE3A4]
	(No symbol) [0x002BAE08]
	(No symbol) [0x002BAFA7]
	(No symbol) [0x002AD0AE]
	BaseThreadInitThunk [0x76AD7BA9+25]
	RtlInitializeExceptionChain [0x77ADC0CB+107]
	RtlClearBits [0x77ADC04F+191]
	(No symbol) [0x00000000]

2024-12-05 10:25:36,454 [INFO] bit_browser_manager.py:251 - 正在导航到: https://www.airbnb.co.nz/rooms/43435162
2024-12-05 10:25:36,632 [INFO] bit_browser_manager.py:259 - 成功加载页面: https://www.airbnb.co.nz/rooms/43435162
2024-12-05 10:25:36,632 [INFO] advanced_analyzer.py:198 - 
开始分析房源: https://www.airbnb.co.nz/rooms/43435162
2024-12-05 10:25:36,632 [INFO] airbnb_calendar_checker.py:27 - 开始检查房源日历: https://www.airbnb.co.nz/rooms/43435162
2024-12-05 10:25:36,643 [INFO] bit_browser_manager.py:63 - 成功设置 locale cookie
2024-12-05 10:25:36,652 [INFO] bit_browser_manager.py:63 - 成功设置 currency cookie
2024-12-05 10:25:36,658 [ERROR] bit_browser_manager.py:82 - 设置语言偏好时发生错误: Message: unknown error: unhandled inspector error: {"code":-32000,"message":"Another locale override is already in effect"}
  (Session info: chrome=126.0.6478.255)
Stacktrace:
	GetHandleVerifier [0x0031FD33+27651]
	(No symbol) [0x002B5554]
	(No symbol) [0x001B1ADF]
	(No symbol) [0x0019CF7D]
	(No symbol) [0x0019BC03]
	(No symbol) [0x0019C35D]
	(No symbol) [0x0019C2F8]
	(No symbol) [0x001B4804]
	(No symbol) [0x00237381]
	(No symbol) [0x0021390C]
	(No symbol) [0x0022CA7D]
	(No symbol) [0x002136A6]
	(No symbol) [0x001E74E1]
	(No symbol) [0x001E805D]
	GetHandleVerifier [0x005D6613+2872547]
	GetHandleVerifier [0x0062BADD+3221933]
	GetHandleVerifier [0x003A2A94+563556]
	GetHandleVerifier [0x003A9DCC+593052]
	(No symbol) [0x002BE3A4]
	(No symbol) [0x002BAE08]
	(No symbol) [0x002BAFA7]
	(No symbol) [0x002AD0AE]
	BaseThreadInitThunk [0x76AD7BA9+25]
	RtlInitializeExceptionChain [0x77ADC0CB+107]
	RtlClearBits [0x77ADC04F+191]
	(No symbol) [0x00000000]

2024-12-05 10:25:36,781 [INFO] airbnb_calendar_checker.py:35 - 页面加载中...
2024-12-05 10:25:45,084 [WARNING] bit_browser_manager.py:317 - 未找到翻译提示框关闭按钮
2024-12-05 10:25:45,085 [ERROR] airbnb_calendar_checker.py:47 - 页面加载超时: Message: no such window: target window already closed
from unknown error: web view not found
  (Session info: chrome=126.0.6478.255)
Stacktrace:
	GetHandleVerifier [0x0031FD33+27651]
	(No symbol) [0x002B5554]
	(No symbol) [0x001B1ADF]
	(No symbol) [0x0018E483]
	(No symbol) [0x00219FCF]
	(No symbol) [0x0022C336]
	(No symbol) [0x002136A6]
	(No symbol) [0x001E74E1]
	(No symbol) [0x001E805D]
	GetHandleVerifier [0x005D6613+2872547]
	GetHandleVerifier [0x0062BADD+3221933]
	GetHandleVerifier [0x003A2A94+563556]
	GetHandleVerifier [0x003A9DCC+593052]
	(No symbol) [0x002BE3A4]
	(No symbol) [0x002BAE08]
	(No symbol) [0x002BAFA7]
	(No symbol) [0x002AD0AE]
	BaseThreadInitThunk [0x76AD7BA9+25]
	RtlInitializeExceptionChain [0x77ADC0CB+107]
	RtlClearBits [0x77ADC04F+191]
	(No symbol) [0x00000000]

2024-12-05 10:25:45,086 [INFO] airbnb_calendar_checker.py:56 - 没有找到需要关闭的模态框或关闭失败
2024-12-05 10:25:45,091 [ERROR] airbnb_calendar_checker.py:90 - 未找到日历按钮
2024-12-05 10:25:45,091 [ERROR] advanced_analyzer.py:204 - 获取日历数据失败: https://www.airbnb.co.nz/rooms/43435162
2024-12-05 10:25:45,092 [ERROR] bit_browser_manager.py:347 - 关闭标签页时发生错误: Message: no such window: target window already closed
from unknown error: web view not found
  (Session info: chrome=126.0.6478.255)
Stacktrace:
	GetHandleVerifier [0x0031FD33+27651]
	(No symbol) [0x002B5554]
	(No symbol) [0x001B1ADF]
	(No symbol) [0x0018E483]
	(No symbol) [0x00219FCF]
	(No symbol) [0x0021F65B]
	(No symbol) [0x002138D3]
	(No symbol) [0x001E74E1]
	(No symbol) [0x001E805D]
	GetHandleVerifier [0x005D6613+2872547]
	GetHandleVerifier [0x0062BADD+3221933]
	GetHandleVerifier [0x003A2A94+563556]
	GetHandleVerifier [0x003A9DCC+593052]
	(No symbol) [0x002BE3A4]
	(No symbol) [0x002BAE08]
	(No symbol) [0x002BAFA7]
	(No symbol) [0x002AD0AE]
	BaseThreadInitThunk [0x76AD7BA9+25]
	RtlInitializeExceptionChain [0x77ADC0CB+107]
	RtlClearBits [0x77ADC04F+191]
	(No symbol) [0x00000000]

2024-12-05 10:25:47,143 [INFO] advanced_analyzer.py:427 - === 程序执行完成 ===
